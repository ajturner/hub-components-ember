(window.webpackJsonp_ember_auto_import_=window.webpackJsonp_ember_auto_import_||[]).push([[11],{45:function(e,t,r){"use strict"
r.r(t)
var n=r(0),i=r(47),o=r(46)
function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(49)
var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])
return e}).apply(this,arguments)}
function u(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})}function l(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1]
return i[1]},trys:[],ops:[]}
return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o
function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.")
for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i
switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o
break
case 4:return a.label++,{value:o[1],done:!1}
case 5:a.label++,n=o[1],o=[0]
continue
case 7:o=a.ops.pop(),a.trys.pop()
continue
default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0
continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1]
break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o
break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o)
break}i[2]&&a.ops.pop(),a.trys.pop()
continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1]
return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(e){return Object.keys(e).some(function(t){var r=e[t]
if(!r)return!1
switch(r&&r.toParam&&(r=r.toParam()),r.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1
default:return!0}})}function d(e){var t={}
return Object.keys(e).forEach(function(r){var n=e[r]
if(n&&n.toParam&&(n=n.toParam()),n||0===n||"boolean"==typeof n||"string"==typeof n){var i
switch(n.constructor.name){case"Array":i=n[0]&&n[0].constructor&&"Object"===n[0].constructor.name?JSON.stringify(n):n.join(",")
break
case"Object":i=JSON.stringify(n)
break
case"Date":i=n.valueOf()
break
case"Function":i=null
break
case"Boolean":i=n+""
break
default:i=n}(i||0===i||"string"==typeof i)&&(t[r]=i)}}),t}function f(e){var t=d(e)
return Object.keys(t).map(function(e){return function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}(e,t[e])}).join("&")}var h=function(e,t,r,n,i){e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=r,this.url=n,this.options=i}
function g(e){console&&console.warn&&console.warn.apply(console,[e])}h.prototype=Object.create(Error.prototype),h.prototype.constructor=h
var m={httpMethod:"POST",params:{f:"json"}},y=function(e){function t(t,r,n,i,o){void 0===t&&(t="AUTHENTICATION_ERROR"),void 0===r&&(r="AUTHENTICATION_ERROR_CODE")
var a=e.call(this,t,r,n,i,o)||this
return a.name="ArcGISAuthError",a.message="AUTHENTICATION_ERROR_CODE"===r?t:r+": "+t,a}return function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.retry=function(e,t){var r=this
void 0===t&&(t=3)
var n=0
return new Promise(function(i,o){!function i(o,a){e(r.url,r.options).then(function(e){var t=c({},r.options,{authentication:e})
return n+=1,b(r.url,t)}).then(function(e){o(e)}).catch(function(e){"ArcGISAuthError"===e.name&&n<t?i(o,a):"ArcGISAuthError"===e.name&&n>=t?a(r):a(e)})}(i,o)})},t}(h)
function b(e,t){void 0===t&&(t={params:{f:"json"}})
var r=c({httpMethod:"POST"},m,t,{params:c({},m.params,t.params),headers:c({},m.headers,t.headers)}),n=[],i=[]
if(r.fetch||"undefined"==typeof fetch?(n.push("`fetch`"),i.push("`node-fetch`")):r.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(n.push("`Promise`"),i.push("`es6-promise`")),"undefined"==typeof FormData&&(n.push("`FormData`"),i.push("`isomorphic-form-data`")),!r.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+n.join(", ")+". We recommend installing the "+i.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.")
var o=r.httpMethod,a=r.authentication,s=r.rawResponse,u=c({f:"json"},r.params),l=null,g={method:o,credentials:"same-origin"}
return(a?a.getToken(e,{fetch:r.fetch}).catch(function(t){return t.url=e,t.options=r,l=t,Promise.resolve("")}):Promise.resolve("")).then(function(t){if(t.length&&(u.token=t),"GET"===g.method){var n=""===f(u)?e:e+"?"+f(u)
r.maxUrlLength&&n.length>r.maxUrlLength?g.method="POST":e=n}var i=new RegExp("/items/.+/updateResources").test(e)
return"POST"===g.method&&(g.body=function(e,t){var r=p(e)||t,n=d(e)
if(r){var i=new FormData
return Object.keys(n).forEach(function(e){if("undefined"!=typeof Blob&&n[e]instanceof Blob){var t=n.fileName||n[e].name||e
i.append(e,n[e],t)}else i.append(e,n[e])}),i}return f(e)}(u,i)),g.headers=c({},r.headers),"undefined"!=typeof window||g.headers.referer||(g.headers.referer="@esri/arcgis-rest-js"),p(u)||i||(g.headers["Content-Type"]="application/x-www-form-urlencoded"),r.fetch(e,g)}).then(function(t){if(!t.ok){var n=t.status,i=t.statusText
throw new h(i,"HTTP "+n,t,e,r)}if(s)return t
switch(u.f){case"json":case"geojson":return t.json()
case"html":case"text":return t.text()
default:return t.blob()}}).then(function(t){if("json"!==u.f&&"geojson"!==u.f||s)return t
var n=function(e,t,r,n,i){if(e.code>=400){var o=e.message,a=e.code
throw new h(o,a,e,t,n)}if(e.error){var s=e.error,c=(o=s.message,a=s.code,s.messageCode),u=c||a||"UNKNOWN_ERROR_CODE"
if(498===a||499===a||"GWM_0003"===c||400===a&&"Unable to generate token."===o)throw i||new y(o,u,e,t,n)
throw new h(o,u,e,t,n)}if("failed"===e.status||"failure"===e.status){o=void 0,a="UNKNOWN_ERROR_CODE"
try{o=JSON.parse(e.statusMessage).message,a=JSON.parse(e.statusMessage).code}catch(t){o=e.statusMessage||e.message}throw new h(o,a,e,t,n)}return e}(t,e,0,r,l)
if(l){var i=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0]
r.authentication.trustedServers[i]={token:[],expires:new Date(Date.now()+864e5)},l=null}return n})}function v(e,t,r){var n=c({params:{}},r,e)
return n.params=t.reduce(function(t,r){return(e[r]||"boolean"==typeof e[r])&&(t[r]=e[r]),t},n.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce(function(e,t){return n[t]&&(e[t]=n[t]),e},{})}function w(e){return"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}function k(e){return void 0===e&&(e={}),e.portal?w(e.portal):e.authentication?e.authentication.portal:"https://www.arcgis.com/sharing/rest"}function x(e,t){return b(k(t)+"/content/items/"+e,c({httpMethod:"GET"},t))}function O(e,t){var r=k(t)+"/content/items/"+e+"/data",n=c({httpMethod:"GET",params:{}},t)
return n.file&&(n.params.f=null),b(r,n).catch(function(e){if(!RegExp(/Unexpected end of (JSON input|data at line 1 column 1)/i).test(e.message))throw e})}var T=function(){function e(e){void 0===e&&(e=""),this.termStack=[],this.rangeStack=[],this.openGroups=0,this.q=e}return e.prototype.match=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
return this.termStack=this.termStack.concat(e),this},e.prototype.in=function(e){var t="`in("+(e?'"'+e+'"':"")+")`"
return this.hasRange||this.hasTerms?(e&&"*"!==e&&(this.q+=e+":"),this.commit()):(g(t+" was called with no call to `match(...)` or `from(...)`/`to(...)`. Your query was not modified."),this)},e.prototype.startGroup=function(){return this.commit(),this.openGroups>0&&(this.q+=" "),this.openGroups++,this.q+="(",this},e.prototype.endGroup=function(){return this.openGroups<=0?(g("`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified."),this):(this.commit(),this.openGroups--,this.q+=")",this)},e.prototype.and=function(){return this.addModifier("and")},e.prototype.or=function(){return this.addModifier("or")},e.prototype.not=function(){return this.addModifier("not")},e.prototype.from=function(e){return this.hasTerms?(g("`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Your query was not modified."),this):(this.rangeStack[0]=e,this)},e.prototype.to=function(e){return this.hasTerms?(g("`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Your query was not modified."),this):(this.rangeStack[1]=e,this)},e.prototype.boost=function(e){return this.commit(),this.q+="^"+e,this},e.prototype.toParam=function(){return this.commit(),this.cleanup(),this.q},e.prototype.clone=function(){return this.commit(),this.cleanup(),new e(this.q+"")},e.prototype.addModifier=function(e){return this.currentModifer?(g("You have called `"+this.currentModifer+"()` after `"+e+"()`. Your current query was not modified."),this):(this.commit(),""===this.q&&"not"!==e?(g("You have called `"+e+"()` without calling another method to modify your query first. Try calling `match()` first."),this):(this.currentModifer=e,this.q+=""===this.q?"":" ",this.q+=e.toUpperCase()+" ",this))},e.prototype.hasWhiteSpace=function(e){return/\s/g.test(e)},e.prototype.formatTerm=function(e){return e instanceof Date?e.getTime():"string"==typeof e&&this.hasWhiteSpace(e)?'"'+e+'"':e},e.prototype.commit=function(){var e=this
return this.currentModifer=void 0,this.hasRange&&(this.q+="["+this.formatTerm(this.rangeStack[0])+" TO "+this.formatTerm(this.rangeStack[1])+"]",this.rangeStack=[void 0,void 0]),this.hasTerms&&(this.q+=this.termStack.map(function(t){return e.formatTerm(t)}).join(" "),this.termStack=[]),this},Object.defineProperty(e.prototype,"hasTerms",{get:function(){return this.termStack.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasRange",{get:function(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]},enumerable:!0,configurable:!0}),e.prototype.cleanup=function(){if(this.openGroups>0)for(g("Automatically closing "+this.openGroups+" group(s). You can use `endGroup(...)` to remove this warning.");this.openGroups>0;)this.q+=")",this.openGroups--
var e=this.q
this.q=e.replace(/( AND ?| NOT ?| OR ?)*$/,""),e!==this.q&&g("`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified."),this.q=this.q.replace(/(\(\))*/,"")},e}()
function S(e){return function e(t,r){var n
n="string"==typeof t||t instanceof T?{httpMethod:"GET",params:{q:t}}:v(t,["q","num","start","sortField","sortOrder"],{httpMethod:"GET"})
var i="item"===r?"/search":"/community/groups"
switch(r){case"item":i="/search"
break
case"group":i="/community/groups"
break
default:i="/portals/self/users/search"}return b(k(n)+i,n).then(function(n){return n.nextStart&&-1!==n.nextStart&&(n.nextPage=function(){var i
return"string"==typeof t||t instanceof T?i={q:t,start:n.nextStart}:(i=t).start=n.nextStart,e(i,r)}),n})}(e,"item")}function _(e){return k(e)+"/community/users/"+encodeURIComponent(e.username)}function j(e,t){var r=t
return r.rawResponse=!1,b(e,r).then(function(e){var t={token:e.access_token,username:e.username,expires:new Date(Date.now()+(1e3*e.expires_in-1e3)),ssl:!0===e.ssl}
return e.refresh_token&&(t.refreshToken=e.refresh_token),t})}function I(e,t){var r=t
return"undefined"!=typeof window&&window.location&&window.location.host?r.params.referer=window.location.host:r.params.referer="@esri/arcgis-rest-js",b(e,r)}var E=/^https?:\/\/(\S+)\.arcgis\.com.+/
function A(e){return E.test(e)}function D(e){if(!E.test(e))return null
var t=e.match(E)[1].split(".").pop()
return t.includes("dev")?"dev":t.includes("qa")?"qa":"production"}var P=function(){function e(e){if(this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this.username=e.username,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?w(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.refreshTokenTTL=e.refreshTokenTTL||1440,this.trustedServers={},e.server){var t=this.getServerRootUrl(e.server)
this.trustedServers[t]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}return e.beginOAuth2=function(t,r){void 0===r&&(r=window)
var n,i=c({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",duration:20160,popup:!0,state:t.clientId,locale:""},t),o=i.portal,a=i.provider,s=i.clientId,u=i.duration,l=i.redirectUri,p=i.popup,d=i.state,h=i.locale,g=i.params
if(n="arcgis"===a?o+"/oauth2/authorize?client_id="+s+"&response_type=token&expiration="+u+"&redirect_uri="+encodeURIComponent(l)+"&state="+d+"&locale="+h:o+"/oauth2/social/authorize?client_id="+s+"&socialLoginProviderName="+a+"&autoAccountCreateForSocial=true&response_type=token&expiration="+u+"&redirect_uri="+encodeURIComponent(l)+"&state="+d+"&locale="+h,g&&(n=n+"&"+f(g)),p){var m,b=((m={promise:null,resolve:null,reject:null}).promise=new Promise(function(e,t){m.resolve=e,m.reject=t}),m)
return r["__ESRI_REST_AUTH_HANDLER_"+s]=function(t,r){if(t){var n=JSON.parse(t)
b.reject(new y(n.errorMessage,n.error))}else if(r){var i=JSON.parse(r)
b.resolve(new e({clientId:s,portal:o,ssl:i.ssl,token:i.token,tokenExpires:new Date(i.expires),username:i.username}))}},r.open(n,"oauth-window","height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes"),b.promise}r.location.href=n},e.completeOAuth2=function(t,r){void 0===r&&(r=window)
var n=c({portal:"https://www.arcgis.com/sharing/rest",popup:!0},t),i=n.portal,o=n.clientId,a=n.popup
function s(t,n){try{var s
if(a&&r.opener&&r.opener.parent&&r.opener.parent["__ESRI_REST_AUTH_HANDLER_"+o])return(s=r.opener.parent["__ESRI_REST_AUTH_HANDLER_"+o])&&s(t?JSON.stringify(t):void 0,JSON.stringify(n)),void r.close()
if(a&&r!==r.parent&&r.parent&&r.parent["__ESRI_REST_AUTH_HANDLER_"+o])return(s=r.parent["__ESRI_REST_AUTH_HANDLER_"+o])&&s(t?JSON.stringify(t):void 0,JSON.stringify(n)),void r.close()}catch(e){throw new y('Unable to complete authentication. It\'s possible you specified popup based oAuth2 but no handler from "beginOAuth2()" present. This generally happens because the "popup" option differs between "beginOAuth2()" and "completeOAuth2()".')}if(t)throw new y(t.errorMessage,t.error)
return new e({clientId:o,portal:i,ssl:n.ssl,token:n.token,tokenExpires:n.expires,username:n.username})}var u=r.location.href.match(/access_token=(.+)&expires_in=(.+)&username=([^&]+)/)
if(!u){var l=r.location.href.match(/error=(.+)&error_description=(.+)/)
return s({error:l[1],errorMessage:decodeURIComponent(l[2])})}var p=u[1],d=new Date(Date.now()+1e3*parseInt(u[2],10)-6e4),f=decodeURIComponent(u[3])
return s(void 0,{token:p,expires:d,ssl:r.location.href.indexOf("&ssl=true")>-1||r.location.href.indexOf("#ssl=true")>-1,username:f})},e.authorize=function(e,t){var r=c({portal:"https://arcgis.com/sharing/rest",duration:20160},e),n=r.portal,i=r.clientId,o=r.duration,a=r.redirectUri
t.writeHead(301,{Location:n+"/oauth2/authorize?client_id="+i+"&duration="+o+"&response_type=code&redirect_uri="+encodeURIComponent(a)}),t.end()},e.exchangeAuthorizationCode=function(t,r){var n=c({portal:"https://www.arcgis.com/sharing/rest",refreshTokenTTL:1440},t),i=n.portal,o=n.clientId,a=n.redirectUri,s=n.refreshTokenTTL
return j(i+"/oauth2/token",{params:{grant_type:"authorization_code",client_id:o,redirect_uri:a,code:r}}).then(function(t){return new e({clientId:o,portal:i,ssl:t.ssl,redirectUri:a,refreshToken:t.refreshToken,refreshTokenTTL:s,refreshTokenExpires:new Date(Date.now()+1e3*(s-1)),token:t.token,tokenExpires:t.expires,username:t.username})})},e.deserialize=function(t){var r=JSON.parse(t)
return new e({clientId:r.clientId,refreshToken:r.refreshToken,refreshTokenExpires:new Date(r.refreshTokenExpires),username:r.username,password:r.password,token:r.token,tokenExpires:new Date(r.tokenExpires),portal:r.portal,ssl:r.ssl,tokenDuration:r.tokenDuration,redirectUri:r.redirectUri,refreshTokenTTL:r.refreshTokenTTL})},e.fromCredential=function(t){return new e({portal:t.server.includes("sharing/rest")?t.server:t.server+"/sharing/rest",ssl:t.ssl,token:t.token,username:t.userId,tokenExpires:new Date(t.expires)})},Object.defineProperty(e.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenExpires",{get:function(){return this._tokenExpires},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"refreshToken",{get:function(){return this._refreshToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"refreshTokenExpires",{get:function(){return this._refreshTokenExpires},enumerable:!0,configurable:!0}),e.prototype.toCredential=function(){return{expires:this.tokenExpires.getTime(),server:this.portal,ssl:this.ssl,token:this.token,userId:this.username}},e.prototype.getUser=function(e){var t=this
return this._user&&this._user.username===this.username?Promise.resolve(this._user):b(this.portal+"/community/users/"+encodeURIComponent(this.username),c({httpMethod:"GET",authentication:this},e,{rawResponse:!1})).then(function(e){return t._user=e,e})},e.prototype.getToken=function(e,t){return n=e,i=A(r=this.portal),o=A(n),a=D(r),s=D(n),i&&o&&a===s||new RegExp(this.portal,"i").test(e)?this.getFreshToken(t):this.getTokenForServer(e,t)
var r,n,i,o,a,s},e.prototype.toJSON=function(){return{clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,refreshTokenTTL:this.refreshTokenTTL}},e.prototype.serialize=function(){return JSON.stringify(this)},e.prototype.refreshSession=function(e){return this._user=null,this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new y("Unable to refresh token."))},e.prototype.getServerRootUrl=function(e){var t=w(e).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/)[0].match(/(https?:\/\/)(.+)/),r=t[1],n=t[2].split("/"),i=n[0],o=n.slice(1)
return""+r+i.toLowerCase()+"/"+o.join("/")},e.prototype.getTokenForServer=function(e,t){var r=this,n=this.getServerRootUrl(e),i=this.trustedServers[n]
return i&&i.expires&&i.expires.getTime()>Date.now()?Promise.resolve(i.token):(this._pendingTokenRequests[n]||(this._pendingTokenRequests[n]=b(n+"/rest/info").then(function(i){if(i.owningSystemUrl){if(function(e,t){var r=w(function(e){if(!E.test(e))return e
switch(D(e)){case"dev":return"https://devext.arcgis.com/sharing/rest"
case"qa":return"https://qaext.arcgis.com/sharing/rest"
default:return"https://www.arcgis.com/sharing/rest"}}(t)).replace(/https?:\/\//,""),n=w(e).replace(/https?:\/\//,"")
return new RegExp(n,"i").test(r)}(i.owningSystemUrl,r.portal))return b(i.owningSystemUrl+"/sharing/rest/info",t)
throw new y(e+" is not federated with "+r.portal+".","NOT_FEDERATED")}if(i.authInfo&&void 0!==r.trustedServers[n])return Promise.resolve({authInfo:i.authInfo})
throw new y(e+" is not federated with any portal and is not explicitly trusted.","NOT_FEDERATED")}).then(function(e){return e.authInfo.tokenServicesUrl}).then(function(t){return r.token&&r.tokenExpires.getTime()>Date.now()?I(t,{params:{token:r.token,serverUrl:e,expiration:r.tokenDuration,client:"referer"}}):I(t,{params:{username:r.username,password:r.password,expiration:r.tokenDuration,client:"referer"}}).then(function(e){return r._token=e.token,r._tokenExpires=new Date(e.expires),e})}).then(function(e){return r.trustedServers[n]={expires:new Date(e.expires),token:e.token},delete r._pendingTokenRequests[n],e.token})),this._pendingTokenRequests[n])},e.prototype.getFreshToken=function(e){var t=this
return this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshSession(e).then(function(e){return t._pendingTokenRequests[t.portal]=null,e.token})),this._pendingTokenRequests[this.portal])},e.prototype.refreshWithUsernameAndPassword=function(e){var t=this,r=c({params:{username:this.username,password:this.password,expiration:this.tokenDuration}},e)
return I(this.portal+"/generateToken",r).then(function(e){return t._token=e.token,t._tokenExpires=new Date(e.expires),t})},e.prototype.refreshWithRefreshToken=function(e){var t=this
if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()<Date.now())return this.refreshRefreshToken(e)
var r=c({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},e)
return j(this.portal+"/oauth2/token",r).then(function(e){return t._token=e.token,t._tokenExpires=e.expires,t})},e.prototype.refreshRefreshToken=function(e){var t=this,r=c({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},e)
return j(this.portal+"/oauth2/token",r).then(function(e){return t._token=e.token,t._tokenExpires=e.expires,t._refreshToken=e.refreshToken,t._refreshTokenExpires=new Date(Date.now()+60*(t.refreshTokenTTL-1)*1e3),t})},e}()
function R(e){var t={}
if(Array.isArray(e))t=e.map(R)
else if("object"===a(e))for(var r in e)null!=e[r]&&"object"===a(e[r])?t[r]=R(e[r]):t[r]=e[r]
else t=e
return t}function C(e,t){return t.split(".").reduce(function(e,t){return e?e[t]:void 0},e)}function M(e,t,r){return r.indexOf(e)===t}var q={app:["Application","Dashboard","Form","Insights Page","Insights Workbook","Operation View","Web Mapping Application","StoryMap"],dataset:["CSV Collection","CSV","Feature Collection Template","Feature Collection","Feature Layer","Feature Service","File Geodatabase","GeoJSON","GeoJson","KML Collection","KML","Microsoft Excel","Raster Layer","Shapefile","Stream Service","Table"],document:["CAD Drawing","Document Link","Hub Page","Site Page","Image","iWork Keynote","iWork Numbers","iWork Pages","Microsoft Powerpoint","Microsoft Visio","Microsoft Word","PDF","Pro Map","Report Template"],event:["Hub Event"],initiative:["Hub Initiative"],map:["City Engine Web Scene","CityEngine Web Scene","Image Collection","Image Service","Map Service Layer","Map Service","Scene Service","Vector Tile Service","Web Map Service","Web Map Tile Service","Web Map","Web Scene","WFS","WMS"],other:["360 VR Experience","AppBuilder Widget Package","Application Configuration","ArcPad Package","Code Attachment","Code Sample","Desktop Add In","Desktop Application Template","Desktop Application","Desktop Style","Explorer Add In","Explorer Layer","Geocoding Service","Geometry Service","Geoprocessing Package","Geoprocessing Sample","Geoprocessing Service","Layer File","Layer Package","Layer Template","Layer","Layout","Locator Package","Map Area","Map Document","Map Package","Map Service Definition","Map Template","Mobile Application","Mobile Map Package","Native Application","Network Analysis Service","Operations Dashboard Add In","Project Package","Project Template","Raster Function Template","Rule Package","Scene Package","Service Definition","SQLite Geodatabase","Style","Tile Package","Vector Tile Package","Workflow Manager Package"],site:["Hub Site Application"],downloadableTypes:["360 VR Experience","Application","CityEngine Web Scene","Code Sample","CSV Collection","CSV","CAD Drawing","Desktop Application","Desktop Application Template","Desktop Style","File Geodatabase","GeoJson","Geoprocessing Package","Geoprocessing Sample","Image","iWork Keynote","iWork Numbers","KML Collection","KML","Layer","Layer File","Layer Package","Layout","Locator Package","Map Package","Map Service Definition","Map Template","Microsoft Excel","Microsoft Powerpoint","Microsoft Visio","Microsoft Word","Operations Dashboard Add In","PDF","Pro Map","Project Package","Project Template","Raster function template","Rule Package","Service Definition","Shapefile","Vector Tile Package","Workflow Manager Package"],downloadableTypeKeywords:["Data"],apiTypes:["Feature Service","Map Service","Image Service"]},N={}
function L(e){if(void 0===e&&(e=""),N[e])return N[e]
for(var t=0,r=Object.keys(q);t<r.length;t++)for(var n=r[t],i=0,o=q[n];i<o.length;i++){var a=o[i]
if(e.toLowerCase()===a.toLowerCase())return N[e]=n,n}}function F(e){void 0===e&&(e={})
var t=L(function(e){void 0===e&&(e={})
var t=e.typeKeywords||[]
if("Web Mapping Application"===e.type){if(t.includes("hubSite"))return"Hub Site Application"
if(t.includes("hubPage"))return"Hub Page"}return e.type}(e))
if(t){var r=Array.from(t)
return r[0]=r[0].toUpperCase(),[r.join("")]}return["Other"]}r.d(t,"calcite_loader",function(){return U}),r.d(t,"hub_button",function(){return G}),r.d(t,"hub_card",function(){return W}),r.d(t,"hub_content_card",function(){return H}),r.d(t,"hub_follow_button",function(){return ae}),r.d(t,"hub_input",function(){return pe}),r.d(t,"hub_map",function(){return me}),r.d(t,"hub_radar",function(){return ye}),r.d(t,"hub_search",function(){return Fe}),r.d(t,"hub_suggest_input",function(){return ze})
var z=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length
var n=Array(e),i=0
for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a]
return n},U=function(){function e(e){Object(n.h)(this,e),this.isActive=!1,this.inline=!1,this.type="indeterminate",this.value=0,this.text="",this.loaderBarOffsets=[0,0,0],this.loaderBarRates=[1,2.25,3.5],this.isEdge=!1,this.animationID=null,this.guid="calcite-loader-"+Object(i.a)()}return e.prototype.componentWillLoad=function(){this.isEdge=/Edge/.test(navigator.userAgent),this.isEdge&&this.updateOffset()},e.prototype.componentDidUnload=function(){this.animationID&&window.cancelAnimationFrame(this.animationID)},e.prototype.render=function(){var e=Object(o.d)(this.el),t=this.el.id||this.guid,r={"aria-valuenow":this.value,"aria-valuemin":0,"aria-valuemax":100},i=this.inline?16:56,a=this.inline?"0 0 16 16":"0 0 56 56",s="determinate"===this.type,c={}
this.isEdge&&(c["--calcite-loader-offset"]=this.loaderBarOffsets[0]+"%",c["--calcite-loader-offset2"]=this.loaderBarOffsets[1]+"%",c["--calcite-loader-offset3"]=this.loaderBarOffsets[2]+"%")
var u={"--calcite-loader-progress":-400-4*this.value+"%"}
return Object(n.g)(n.a,Object.assign({id:t,dir:e,role:"progressbar"},"determinate"===this.type?r:{},{style:c}),Object(n.g)("svg",{viewBox:a,class:"loader__square"},Object(n.g)("rect",{width:i,height:i})),Object(n.g)("svg",{viewBox:a,class:"loader__square loader__square--2"},Object(n.g)("rect",{width:i,height:i})),Object(n.g)("svg",{viewBox:a,class:"loader__square loader__square--3",style:s?u:{}},Object(n.g)("rect",{width:i,height:i})),this.text?Object(n.g)("div",{class:"loader__text"},this.text):"",this.value?Object(n.g)("div",{class:"loader__percentage"},Math.floor(this.value)):"")},e.prototype.updateOffset=function(){var e=this
this.loaderBarOffsets=this.rotateLoaderBars(this.loaderBarOffsets),this.animationID=window.requestAnimationFrame(function(){return e.updateOffset()})},e.prototype.rotateLoaderBars=function(e){var t=this
return e.map(function(e,r){return e>-400?e-t.loaderBarRates[r]:0})},Object.defineProperty(e.prototype,"el",{get:function(){return Object(n.f)(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return":root{--calcite-ui-blue:#007ac2;--calcite-ui-blue-hover:#2890ce;--calcite-ui-blue-press:#00619b;--calcite-ui-green:#35ac46;--calcite-ui-green-hover:#50ba5f;--calcite-ui-green-press:#288835;--calcite-ui-yellow:#edd317;--calcite-ui-yellow-hover:#f9e54e;--calcite-ui-yellow-press:#d9bc00;--calcite-ui-red:#d83020;--calcite-ui-red-hover:#e65240;--calcite-ui-red-press:#a82b1e;--calcite-ui-background:#f8f8f8;--calcite-ui-foreground:#fff;--calcite-ui-foreground-hover:#f3f3f3;--calcite-ui-foreground-press:#eaeaea;--calcite-ui-text-1:#151515;--calcite-ui-text-2:#4a4a4a;--calcite-ui-text-3:#6a6a6a;--calcite-ui-border-1:#cacaca;--calcite-ui-border-2:#dfdfdf;--calcite-ui-border-3:#eaeaea;--calcite-ui-border-hover:#9f9f9f;--calcite-ui-border-press:#757575}:host([theme=dark]){--calcite-ui-blue:#00a0ff;--calcite-ui-blue-hover:#0087d7;--calcite-ui-blue-press:#47bbff;--calcite-ui-green:#36da43;--calcite-ui-green-hover:#11ad1d;--calcite-ui-green-press:#44ed51;--calcite-ui-yellow:#ffc900;--calcite-ui-yellow-hover:#f4b000;--calcite-ui-yellow-press:#ffe24d;--calcite-ui-red:#fe583e;--calcite-ui-red-hover:#f3381b;--calcite-ui-red-press:#ff7465;--calcite-ui-background:#202020;--calcite-ui-foreground:#2b2b2b;--calcite-ui-foreground-hover:#353535;--calcite-ui-foreground-press:#404040;--calcite-ui-text-1:#fff;--calcite-ui-text-2:#bfbfbf;--calcite-ui-text-3:#9f9f9f;--calcite-ui-border-1:#4a4a4a;--calcite-ui-border-2:#404040;--calcite-ui-border-3:#353535;--calcite-ui-border-hover:#757575;--calcite-ui-border-press:#9f9f9f}:root{--calcite-border-radius:3px}:host([hidden]){display:none}body{font-family:Avenir Next W01,Avenir Next W00,Avenir Next,Avenir,Helvetica Neue,sans-serif}.overflow-hidden{overflow:hidden}calcite-tab{display:none}calcite-tab[is-active]{display:block}a{color:#007ac2}:host{--calcite-loader-spot:var(--calcite-ui-blue);--calcite-loader-spot-light:var(--calcite-ui-blue);--calcite-loader-spot-dark:var(--calcite-ui-blue);--calcite-loader-neutral:#eaeaea;--calcite-loader-padding:4rem}:host([theme=dark]){--calcite-loader-neutral:#151515}:host([no-padding]){--calcite-loader-padding:0}:host{position:relative;display:none;padding-bottom:var(--calcite-loader-padding);padding-top:var(--calcite-loader-padding);margin-left:auto;margin-right:auto;min-height:54px;stroke:var(--calcite-loader-light);stroke-width:6px;stroke-dashoffset:0;fill:none;animation:loader-color-shift 2s linear infinite alternate-reverse}:host([is-active]){display:block}.loader__text{margin-top:var(--calcite-loader-padding);line-height:1.5}.loader__percentage,.loader__text{display:block;text-align:center;font-size:.875rem}.loader__percentage{left:50%;margin-top:27px;line-height:.25}.loader__percentage,.loader__square{width:54px;position:absolute;top:var(--calcite-loader-padding);margin-left:-27px}.loader__square{height:54px;left:0;left:50%;stroke-dasharray:50% 350%;-webkit-animation:loader-clockwise 2s linear infinite;animation:loader-clockwise 2s linear infinite}.loader__square--2{stroke-dasharray:100% 225% 50% 25%;-webkit-animation:loader-clockwise 1s linear infinite;animation:loader-clockwise 1s linear infinite}.loader__square--3{stroke-dasharray:50% 50% 75% 225%;-webkit-animation:loader-clockwise 1.85s linear infinite;animation:loader-clockwise 1.85s linear infinite}@supports (-ms-ime-align:auto){.loader__square{stroke-dashoffset:var(--calcite-loader-offset);-webkit-animation:none;animation:none}.loader__square--2{stroke-dashoffset:var(--calcite-loader-offset2)}.loader__square--3{stroke-dashoffset:var(--calcite-loader-offset3)}}:host([type=determinate]){stroke:var(--calcite-loader-neutral);-webkit-animation:none;animation:none}:host([type=determinate]) .loader__square--3{stroke:var(--calcite-loader-spot);stroke-dasharray:400%;stroke-dashoffset:var(--calcite-loader-progress);-webkit-transition:all 50ms linear;transition:all 50ms linear;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-animation:none;animation:none}:host([inline]){stroke:currentColor;stroke-width:4px;-webkit-animation:none;animation:none;margin:0;padding-bottom:0;padding-top:0;position:relative;height:16px;min-height:16px;width:16px;margin-right:8px;vertical-align:-2px}:host([inline][dir=rtl]){margin-left:8px;margin-right:0}:host([is-active][inline]){display:inline-block}:host([inline]) .loader__square{margin:0;position:absolute;top:0;left:0;width:16px;height:16px}@-webkit-keyframes loader-color-shift{0%{stroke:var(--calcite-loader-spot-light)}to{stroke:var(--calcite-loader-spot-dark)}}@keyframes loader-color-shift{0%{stroke:var(--calcite-loader-spot-light)}to{stroke:var(--calcite-loader-spot-dark)}}@-webkit-keyframes loader-clockwise{0%{stroke-dashoffset:0}to{stroke-dashoffset:-400%}}@keyframes loader-clockwise{0%{stroke-dashoffset:0}to{stroke-dashoffset:-400%}}"},enumerable:!0,configurable:!0}),e}(),G=function(){function e(e){Object(n.h)(this,e),this.text="Click Me",this.action=function(){return"foo"}}return e.prototype.handleKeyDown=function(){this.action()},e.prototype.render=function(){return Object(n.g)("button",{class:"hub-btn"},this.icon,this.text)},Object.defineProperty(e,"style",{get:function(){return".hub-btn{position:relative;display:inline-block;padding:.375rem 1rem;width:auto;color:#fff;border:1px solid #0079c1;border-radius:0;background-color:#0079c1;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:all .05s linear;transition:all .05s linear;cursor:pointer;white-space:nowrap;font-size:.9375rem;line-height:1.5}.hub-btn:hover{background-color:#005e95;border-color:#005e95}"},enumerable:!0,configurable:!0}),e}(),W=function(){function e(e){Object(n.h)(this,e),this.portalUrl="http://www.arcgis.com/sharing/rest/",this.item="",this.name="Trash Day",this.description="Monday",this.contenttype="Local Topic",this.layout="vertical",this.url="https://hub.arcgis.com",this.actionButton=null,this.metadata=[]}return e.prototype.componentWillRender=function(){},e.prototype.render=function(){var e=[],t=null,r=null
return this.image&&(console.log("item id",this.item),t=Object(n.g)("img",{class:"content-image",src:this.portalUrl+"content/items/"+this.item+"/info/"+this.image,alt:"Thumbnail Image"})),this.contenttype&&e.push(Object(n.g)("span",{class:"content-type"},this.contenttype)),this.name&&e.push(Object(n.g)("div",{class:"content-title",innerHTML:this.name})),this.description&&e.push(Object(n.g)("p",{class:"content-summary",innerHTML:this.description})),this.metadata&&this.metadata.length>0&&(r=Object(n.g)("div",{class:"content-details"},this.metadata.map(function(e){return Object(n.g)("div",null,Object(n.g)("strong",null,e.name),": ",e.value)}))),Object(n.g)(n.a,null,Object(n.g)("div",{class:"content-card layout-"+this.layout},this.url?Object(n.g)("a",{class:"content-link",href:this.url}):"",this.image?t:"",Object(n.g)("div",{class:"content-metadata"},e,r,this.actionButton,Object(n.g)("slot",{name:"action"}),Object(n.g)("hub-follow-button",{clientid:"QVQNb3XfDzoboWS0",initiativeid:"6f28b477336b46a889c16e4ceb61791e"}))))},Object.defineProperty(e,"style",{get:function(){return":host{display:block;font-family:Open Sans,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:16px}.content-card{-webkit-box-shadow:0 4px 8px 0 rgba(0,0,0,.2);box-shadow:0 4px 8px 0 rgba(0,0,0,.2);-webkit-transition:.3s;transition:.3s;margin:10px;border:1px solid #eee;position:relative}.content-card a{position:absolute;height:100%;width:100%;z-index:1}.content-card .content-metadata,.content-card .content-summary,.content-card .content-title{pointer-events:none;position:relative;z-index:10}.content-card:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.2);box-shadow:0 8px 16px 0 rgba(0,0,0,.2)}.content-title{font:#101f28!important;font-size:1rem;font-weight:700}.content-summary,.content-type{font-size:.9rem;color:#666}.layout-vertical.content-card{width:250px}.layout-vertical .content-image{height:150px;-ms-flex:0 0 auto;flex:0 0 auto}.layout-vertical img.content-image{width:100%;-o-object-fit:cover;object-fit:cover}.content-metadata{margin:.5rem .8rem}.layout-horizontal.content-card{display:-ms-flexbox;display:flex}.layout-horizontal .content-image{display:-ms-flexbox;display:flex;-ms-flex:0 0 150px;flex:0 0 150px}.layout-horizontal .content-metadata{-ms-flex:1 1 auto;flex:1 1 auto;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow:hidden}.content-details{color:#4c4c4c;font-size:.8em;-webkit-box-shadow:0 -1px #ccc;box-shadow:0 -1px #ccc;padding:15px 15px 0;grid-template-columns:repeat(2,50%);grid-gap:2px 5px;-ms-flex-align:center;align-items:center;-ms-flex:1 auto;flex:1 auto;display:grid}"},enumerable:!0,configurable:!0}),e}(),H=function(){function e(e){Object(n.h)(this,e),this.content="4f5c78bfe89a4304aec3a6cfd492d0cd",this.layout="vertical",this.contentItem=null}return e.prototype.componentWillLoad=function(){var e=this
null===this.contentItem&&x(this.content).then(function(t){e.contentItem=t})},e.prototype.render=function(){var e=[]
return this.contentItem&&e.push(Object(n.g)("hub-card",{item:this.content,contenttype:this.contentItem.type,layout:this.layout,url:this.contentItem.url,image:this.contentItem.thumbnail,name:this.contentItem.title,description:this.contentItem.snippet})),Object(n.g)(n.a,null,e,this.actionButton)},Object.defineProperty(e,"style",{get:function(){return":host{display:block}"},enumerable:!0,configurable:!0}),e}()
function V(e,t,r,n){var i=(r||"https://www.arcgis.com/sharing/rest")+"/content/items/"+e+"/resources"
return n?i+"/"+n+"/"+t:i+"/"+t}var J=function(e){return Object.keys(e).reduce(function(t,r){var n=e[r]
if(function(e){var t=!1
return Array.isArray(e.fields)&&e.fields.length>0&&(t=!0),t}(n)){var i=R(n)
i.id=r,t.push(i)}return t},[])},B=function(e){return{id:e.id,name:e.field.name,alias:e.field.alias,type:e.field.type}},K=function(e){return{type:"Feature Layer",url:e.url,itemId:e.itemId,layerId:e.layerId,name:e.name||e.id,mappings:e.fields.map(B)}},Q=function(e){return{id:e.id,type:"Data",name:e.name||e.id,definition:{description:e.name||e.id},source:K(e)}},Y=function(e,t){return e&&Array.isArray(e)?e.map(function(e){return n=(r=t[e]).templates||[],i=r.items||[],{title:r.title,description:r.description,id:r.id,templateIds:n.map(Z),itemIds:i.map(Z)}
var r,n,i}):[]}
function Z(e){return e.id}function $(e,t){return 2.1===C(e,"item.properties.schemaVersion")?e:e=function(e){if(C(e,"item.properties.schemaVersion")<2.1){var t=R(e)
t.item.properties.schemaVersion=2.1
var r=C(e,"item.properties.groupId")
return r&&(t.item.properties.collaborationGroupId=r,delete t.item.properties.groupId),t}return e}(e=function(e,t){var r
if(C(e,"item.properties.schemaVersion")<2){var n=R(e)
return n.item.properties.schemaVersion=2,n.data.steps=Y(n.data.values.steps,n.data.values),n.data.values.steps&&(n.data.values.steps.forEach(function(e){delete n.data.values[e]}),delete n.data.values.steps),n.data.indicators=(r=n.data.values,J(r).map(Q)),n}return e}(e=function(e,t){if(C(e,"item.properties.schemaVersion")<1.1){var r=R(e)
return r.item.properties.schemaVersion=1.1,function(e,t){e.data.assets||(e.data.assets=[{id:"bannerImage",url:V(e.item.id,"detail-image.jpg",t),properties:{type:"resource",fileName:"detail-image.jpg",mimeType:"image/jepg"},license:{type:"none"}},{id:"iconDark",url:V(e.item.id,"icon-dark.png",t),properties:{type:"resource",fileName:"icon-dark.png",mimeType:"image/png"},license:{type:"none"}},{id:"iconLight",url:V(e.item.id,"icon-light.png",t),properties:{type:"resource",fileName:"icon-light.png",mimeType:"image/png"},license:{type:"none"}}])}(r,t),r.data.values.bannerImage||(r.data.values.bannerImage={source:"bannerImage",display:{position:{x:"50%",y:"10%"}}}),r}return e}(e=function(e,t){var r=C(e,"item.properties.schemaVersion")
if(!r||r<1){var n=R(e)
n.data.values||(n.data.values={}),n.item.properties||(n.item.properties={}),n.item.properties.schemaVersion=1
var i=!1
if(n.item.typeKeywords&&(i=n.item.typeKeywords.indexOf("hubInitiativeTemplate")>=0),!!n.data.source&&n.item.properties.source!==n.data.source&&(n.item.properties.source=n.data.source),n.data.configurationSettings){var o=R(n.data.configurationSettings)
delete n.data.configurationSettings
var a=o.find(function(e){return"Steps"===e.category})
n.data.values.steps=a.fields.map(function(e){return e.fieldName}),a.fields.forEach(function(e){n.data.values[e.fieldName]||(n.data.values[e.fieldName]={}),n.data.values[e.fieldName].title=e.label,n.data.values[e.fieldName].description=e.tooltip,n.data.values[e.fieldName].id=e.fieldName,n.data.values[e.fieldName].items?i&&(n.data.values[e.fieldName].templates=n.data.values[e.fieldName].items,delete n.data.values[e.fieldName].items):(n.data.values[e.fieldName].items=[],n.data.values[e.fieldName].templates=[])})}return n}return e}(e),t)))}function X(e,t){return Promise.all([x(e,t),O(e,t)]).then(function(e){return{item:e[0],data:e[1]}}).then(function(e){return $(e,k(t))})}var ee=function(e){return"hubInitiativeId|"+e},te=function(e){return e.replace(/^hubInitiativeId\|/,"")},re=function(e){return e.replace(/^hubInitiativeFollowers\|/,"")},ne=function(e){return _(e)+"/update"},ie=function(e){return e.groups.map(function(e){return e.tags}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return 0===e.indexOf("hubInitiativeFollowers|")}).map(re)},oe=function(e,t){return function(e){var t=function(e){return e.tags.map(te)}(e),r=ie(e)
return t.concat(r).filter(M)}(e).indexOf(t)>-1}
var ae=function(){function e(e){var t=this
Object(n.h)(this,e),this.icon=Object(n.g)("svg",{class:"follow-icon",viewBox:"0 0 120 120",width:"100%",height:"100%"},Object(n.g)("circle",{cx:"18.385",cy:"101.615",r:"18.385"}),Object(n.g)("path",{d:"M-1.031 61c32.533 0 59 26.468 59 59s-26.467 59-59 59-59-26.468-59-59 26.467-59 59-59m0-23c-45.288 0-82 36.713-82 82s36.712 82 82 82 82-36.713 82-82-36.712-82-82-82z"}),Object(n.g)("path",{d:"M.154 23.041c53.349 0 96.75 43.402 96.75 96.75s-43.402 96.75-96.75 96.75-96.75-43.402-96.75-96.75 43.402-96.75 96.75-96.75m0-23c-66.136 0-119.75 53.615-119.75 119.75s53.614 119.75 119.75 119.75c66.135 0 119.75-53.615 119.75-119.75S66.289.041.154.041z"})),this.orgurl="https://www.arcgis.com",this.following=!1,this.callToActionText="Follow Our Initiative",this.triggerFollow=function(){var e
return t.session=(e=document.cookie.match("(^|[^;]+)\\s*arcgis_hub_component_auth\\s*=\\s*([^;]+)"))?e.pop():void 0,t.session?t.toggleFollow():P.beginOAuth2({clientId:t.clientid,portal:t.orgurl+"/sharing/rest",redirectUri:window.location+"authenticate.html"}).then(function(e){return function(e){var t=new Date
t.setTime(t.getTime()+12096e5),document.cookie="arcgis_hub_component_auth="+e.serialize()+" ; expires="+t.toUTCString()+" path=/"}(e),t.session=e.serialize(),t.toggleFollow()})},this.toggleFollow=function(){return t.following?(e={initiativeId:t.initiativeid,authentication:P.deserialize(t.session)},b(_(e.authentication),{authentication:e.authentication}).then(function(t){return oe(t,e.initiativeId)?t:Promise.reject("user is not following this initiative.")}).then(function(t){var r=ee(e.initiativeId),n=JSON.parse(JSON.stringify(t.tags))
if(n.indexOf(r)>-1){var i=n.indexOf(r)
return n.splice(i,1),0===n.length&&n.push(","),b(ne(e.authentication),{params:{tags:n},authentication:e.authentication}).then(function(e){return t})}return t}).then(function(t){return X(e.initiativeId,e).then(function(e){return{user:t,initiative:e}})}).then(function(t){var r=C(t,"initiative.item.properties.followersGroupId")
return r&&ie(t.user).indexOf(e.initiativeId)>-1?function(e){return b(k(e)+"/community/groups/"+e.id+"/leave",e)}({id:r,authentication:e.authentication}).then(function(e){return{success:!0,username:t.user.username}}):{success:!0,username:t.user.username}})).then(function(e){if(e.success)return Promise.resolve()}).catch(function(e){if("user is not following this initiative."===e)return Promise.resolve()}).then(function(){return t.callToActionText="Follow Our Initiative",t.following=!1,{success:!0}}):function(e){return b(_(e.authentication),{authentication:e.authentication}).then(function(t){return oe(t,e.initiativeId)?Promise.reject("user is already following this initiative."):t}).then(function(t){return X(e.initiativeId,e).then(function(e){return{user:t,initiative:e,hasFollowersGroup:!1}})}).then(function(t){var r=C(t,"initiative.item.properties.followersGroupId")
return r?function(e){return b(k(e)+"/community/groups/"+e.id+"/join",e)}({id:r,authentication:e.authentication}).then(function(e){return t.hasFollowersGroup=e.success,t}):t}).then(function(t){if(!t.hasFollowersGroup){var r=ee(e.initiativeId),n=JSON.parse(JSON.stringify(t.user.tags))
return n.push(r),b(ne(e.authentication),{params:{tags:n},authentication:e.authentication})}return{success:!0,username:t.user.username}})}({initiativeId:t.initiativeid,authentication:P.deserialize(t.session)}).then(function(e){if(e.success)return Promise.resolve(e)}).catch(function(e){if("user is already following this initiative."===e)return Promise.resolve()}).then(function(){return t.callToActionText="Unfollow Our Initiative",t.following=!0,{success:!0}})
var e}}return e.prototype.render=function(){return Object(n.g)("hub-button",{text:this.callToActionText,action:this.triggerFollow,icon:this.icon})},Object.defineProperty(e,"style",{get:function(){return".follow-icon{height:15px;width:15px;vertical-align:baseline;padding-right:5px;fill:currentColor}"},enumerable:!0,configurable:!0}),e}(),se="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/"
function ce(e,t){return new Promise(function(r,n){console.debug("getLocation extent",t)
var i={address:e}
if(null!=t){var o=z(t[0],t[1]).join(",")
i=Object.assign(i,{params:{searchExtent:o}})}console.log("getLocation geocodeOptions",i),function(e){var t,r={}
return"string"==typeof e?(r.params={singleLine:e},t=se):(t=e.endpoint||se,r=v(e,["singleLine","address","address2","address3","neighborhood","city","subregion","region","postal","postalExt","countryCode","outFields","magicKey"],{params:c({},e.params)})),b(w(t)+"/findAddressCandidates",r).then(function(t){if("string"!=typeof e&&e.rawResponse)return t
var r=t.spatialReference
return t.candidates.forEach(function(e){e.location.spatialReference=r,e.extent&&(e.extent.spatialReference=r)}),t})}(i).then(function(e){if(0==e.candidates.length)throw new Error("No locations found at this address.")
r(e.candidates[0].location)}).catch(n)})}function ue(e,t,r){return e.hasOwnProperty(t)?function(e,t,r){switch(r[t].type){case"esriFieldTypeDate":return new Date(e[t])
default:return e[t]}}(e,t,r):""}function le(e,t){var r={}
t.fields.forEach(function(e){r[e.name]=e})
var n=[],i=e.popupInfo.title,o=e.popupInfo.description
return t.features.forEach(function(e){var t=e.attributes,a=i.replace(/\{(\w*)\}/g,function(e,n){return ue(t,n,r)})
if(null!==o)var s=o.replace(/\{(\w*)\}/g,function(e,n){return ue(t,n,r)})
var c={title:a,description:s||""}
n.push(c)}),n}var pe=function(){function e(e){Object(n.h)(this,e),this.eventAddressUpdated=Object(n.d)(this,"eventAddressUpdated",7)}return e.prototype.componentWillLoad=function(){this.inputAddress=this.address,"string"==typeof this.extent&&(this.extent=JSON.parse(this.extent))},e.prototype.queryInputHandler=function(e){var t=this
return this.inputAddress=e.detail,function(e,t){return new Promise(function(r,n){var i,o,a,s={address:e}
if(null!=t){var u=z(t[0],t[1]).join(",")
s=Object.assign(s,{params:{searchExtent:u}})}(i=e,o=s,a=c({endpoint:se,params:{}},o),a.params.text=i,b(w(a.endpoint)+"/suggest",a)).then(function(e){console.debug("suggestLocations",e),r(e)}).catch(n)})}(this.inputAddress,this.extent).then(function(e){t.addressSuggestions=Array.from(e.suggestions,function(e){return e.text})}).catch(function(e){console.error("Geocode error",e)}),"true"},e.prototype.querySelectHandler=function(e){var t=this
return console.debug("radar-input querySelect",e),ce(e.detail,this.extent).then(function(e){t.eventAddressUpdated.emit({address:t.address,coordinates:e})}).catch(function(e){console.error("Geocode error",e)}),"true"},e.prototype.render=function(){return Object(n.g)("hub-suggest-input",{placeholder:"Search for an address...",query:this.address,suggestions:this.addressSuggestions})},Object.defineProperty(e.prototype,"element",{get:function(){return Object(n.f)(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return""},enumerable:!0,configurable:!0}),e}()
"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self
var de,fe=function(e,t){return function(e,t){!function(e){function t(e){if("next"===e.toLowerCase())return"next"
var t=e&&e.match(/^(\d)\.(\d+)/)
return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e="4.14"),"https://js.arcgis.com/"+e+"/"}function n(e){return!e||t(e)?function(e){void 0===e&&(e="4.14")
var n=r(e),i=t(e)
return"next"!==i&&3===i.major?n+(i.minor<=10?"js/":"")+"esri/css/esri.css":n+"esri/themes/light/main.css"}(e):e}function i(e,t){var r=n(e),i=function(e){return document.querySelector('link[href*="'+e+'"]')}(r)
return i||function(e,t){if(t){var r=document.querySelector(t)
r.parentNode.insertBefore(e,r)}else document.head.appendChild(e)}(i=function(e){var t=document.createElement("link")
return t.rel="stylesheet",t.href=e,t}(r),t),i}var o={Promise:"undefined"!=typeof window?window.Promise:void 0},a={}
function s(e,t,r){var n
r&&(n=function(e,t){var r=function r(n){t(n.error||new Error("There was an error attempting to load "+e.src)),e.removeEventListener("error",r,!1)}
return e.addEventListener("error",r,!1),r}(e,r)),e.addEventListener("load",function r(){t(e),e.removeEventListener("load",r,!1),n&&e.removeEventListener("error",n,!1)},!1)}function c(e){void 0===e&&(e={}),a=e}function u(){return document.querySelector("script[data-esri-loader]")}function l(){var e=window.require
return e&&e.on}function p(e){void 0===e&&(e={})
var t={};[a,e].forEach(function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})
var n=t.version,c=t.url||r(n)
return new o.Promise(function(e,r){var o=u()
if(o){var a=o.getAttribute("src")
a!==c?r(new Error("The ArcGIS API for JavaScript is already loaded ("+a+").")):l()?e(o):s(o,e,r)}else if(l())r(new Error("The ArcGIS API for JavaScript is already loaded."))
else{var p=t.css
p&&i(!0===p?n:p,t.insertCssBefore),t.dojoConfig&&(window.dojoConfig=t.dojoConfig),s(o=function(e){var t=document.createElement("script")
return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}(c),function(){o.setAttribute("data-esri-loader","loaded"),e(o)},r),document.body.appendChild(o)}})}function d(e){return new o.Promise(function(t,r){var n=window.require.on("error",r)
window.require(e,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r]
n.remove(),t(e)})})}function f(e,t){if(void 0===t&&(t={}),l())return d(e)
var r=u(),n=r&&r.getAttribute("src")
return!t.url&&n&&(t.url=n),p(t).then(function(){return d(e)})}var h={getScript:u,isLoaded:l,loadModules:f,loadScript:p,loadCss:i,setDefaultOptions:c,utils:o}
e.getScript=u,e.isLoaded=l,e.loadModules=f,e.loadScript=p,e.loadCss=i,e.setDefaultOptions=c,e.utils=o,e.default=h,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(t={exports:{}},t.exports),t.exports}();(de=fe)&&de.__esModule&&Object.prototype.hasOwnProperty.call(de,"default")&&de.default
var he=fe.loadModules,ge=fe.loadCss,me=function(){function e(e){var t=this
Object(n.h)(this,e),this.zoom=4,this.mapCenter=[-107,38.9],this.esriMapOptions={url:"https://js.arcgis.com/4.14/"},this.webmap=this.webmap?this.webmap:"41281c51f9de45edaf1c8ed44bb10e30",ge(this.esriMapOptions.url+"/esri/css/main.css"),he(["esri/Map"],this.esriMapOptions).then(function(e){var r=e[0]
t.esriMap=new r({basemap:"streets"}),t.centerDidChangeHandler(t.center),t.zoomDidChangeHandler(t.zoom)})}return e.prototype.centerDidChangeHandler=function(e){console.debug("map: centerDidChangeHandler 1",[e,this.esriMapView]),void 0!==e&&this.esriMapView&&(this.mapCenter=JSON.parse(e),console.debug("map: centerDidChangeHandler 2",[this.mapCenter,this.zoom]),this.esriMapView.goTo({zoom:this.zoom,center:this.mapCenter}))},e.prototype.zoomDidChangeHandler=function(e){console.debug("map: zoomDidChangeHandler 1",[e,this.esriMapView]),void 0!==e&&this.esriMapView&&(console.debug("map: zoomDidChangeHandler 2",[this.mapCenter,this.zoom]),this.esriMapView.goTo({zoom:this.zoom,center:this.mapCenter}))},e.prototype.componentWillLoad=function(){this.center&&(this.mapCenter=JSON.parse(this.center))},e.prototype.componentDidUpdate=function(){console.log("component update")},e.prototype.componentDidLoad=function(){this.createEsriMapView()},e.prototype.createEsriMapView=function(){var e=this
return he(["esri/WebMap","esri/views/MapView"],this.esriMapOptions).then(function(t){var r=t[0],n=t[1],i={container:e.hostElement.querySelector("div")}
e.webmap&&(i.map=new r({portalItem:{id:e.webmap}})),e.center&&e.zoom&&(i.center=e.mapCenter,i.zoom=e.zoom),e.esriMapView=new n(i)})},e.prototype.zoomToAndHighlighFeature=function(e,t){var r=this
void 0===t&&(t=1600),this.esriMapView.when(function(){var n=e.clone()
n.set("symbol",{type:"simple-fill",color:[51,51,204,.9],style:"solid",outline:{color:"white",width:1}}),r.esriMapView.graphics.removeAll(),r.esriMapView.graphics.add(n),r.esriMapView.goTo(e.geometry,{duration:t,easing:"ease-in"})})},e.prototype.render=function(){return Object(n.g)(n.a,null,Object(n.g)("div",{class:"hub-map"}))},Object.defineProperty(e.prototype,"hostElement",{get:function(){return Object(n.f)(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"watchers",{get:function(){return{center:["centerDidChangeHandler"],zoom:["zoomDidChangeHandler"]}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return".hub-map,:host{height:100%;min-height:100%}"},enumerable:!0,configurable:!0}),e}(),ye=function(){function e(e){Object(n.h)(this,e),this.showmap=!0,this.isLoading=!1}return e.prototype.handleAddressUpdated=function(e){this.updateRadar(e.detail.address,e.detail.coordinates)},e.prototype.updateRadar=function(e,t){var r=this
this.address=e,this.mapCenter="["+t.x+", "+t.y+"]",this.mapZoom=16,this.isLoading=!0,function(e,t){return new Promise(function(r,n){var i=e.operationalLayers.slice().reverse().map(function(e){return function(e,t){var r={url:e.url,outFields:"*",geometryType:"esriGeometryPoint",inSR:"4326"}
if(-1!==e.title.indexOf("Nearby")){var n=e.title.match(/Nearby (\d+)/),i=void 0
null!==n&&(i=parseInt(n[1])),r.distance=i,r.units="esriSRUnit_Meter"}return r.geometry=t,new Promise(function(t,n){var i,o;(i=r,o=v(i,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"],{httpMethod:"GET",params:c({where:"1=1",outFields:"*"},i.params)}),b(w(i.url)+"/query",o)).then(function(r){var n={title:e.title,features:le(e,r)}
t(n)}).catch(n)})}(e,t)})
Promise.all(i).then(function(e){var t=[]
e.map(function(e){e.features.length>0&&(e.description=e.features[0].title,e.description+="<br/><em>"+e.features[0].description+"</em>"),t.push(e)}),r(t)}).catch(n)})}(this.mapItemData,t).then(function(e){r.messages=e,r.isLoading=!1})},e.prototype.componentWillLoad=function(){},e.prototype.componentDidLoad=function(){var e,t=this;(e=this.webmap,new Promise(function(t,r){Promise.all([x(e),O(e)]).then(t).catch(r)})).then(function(e){var r=e[0],n=e[1]
t.mapItem=r,t.mapItemData=n,t.address&&ce(t.address,r.extent).then(function(e){t.updateRadar(t.address,e)}).catch(function(e){console.log("Geocode error",e)})})},e.prototype.render=function(){var e=[],t={address:this.address,extent:this.mapItem?this.mapItem.extent:null}
return e.push(Object(n.g)("hub-input",Object.assign({},t))),this.showmap&&e.push(Object(n.g)("div",{class:"radar-map"},Object(n.g)("hub-map",{center:this.mapCenter,zoom:this.mapZoom,webmap:this.webmap}))),this.isLoading?e.push(Object(n.g)("calcite-loader",{text:"Scanning radar...","is-active":!0})):void 0!==this.messages&&this.messages.length>0&&(e.push(Object(n.g)("slot",{name:"before-results"})),this.messages.forEach(function(t){e.push(Object(n.g)("hub-card",{layout:"horizontal",contenttype:t.title,name:t.description?t.description:"<em>None</em>"}))})),Object(n.g)(n.a,null,e,Object(n.g)("slot",{name:"after-results"}))},Object.defineProperty(e,"style",{get:function(){return".radar-map{height:200px}"},enumerable:!0,configurable:!0}),e}(),be=q.apiTypes.map(function(e){return e.toLowerCase()})
function ve(e){return Object.keys(e).reduce(function(t,r){return t[r]=Object.keys(e[r]).reduce(function(t,n){return t.push({key:n,docCount:e[r][n]}),t},[]).sort(we),t},{})}function we(e,t){return t.docCount>e.docCount?1:-1}var ke=["tags","type","access","categories"],xe={collection:"type"},Oe=["title","created","type","owner","modified","avgrating","numratings","numcomments","numviews"],Te={name:"title"},Se={orgId:{type:"filter",dataType:"string",defaultOp:"any",catalogDefinition:!0},q:{type:"simple"},page:{type:"simple"},tags:{type:"filter",dataType:"string",defaultOp:"all"},source:{type:"filter",dataType:"string",defaultOp:"any"},bbox:{type:"simple"},location_name:{type:"simple"},sort:{type:"simple"},groupIds:{type:"filter",dataType:"string",defaultOp:"any",catalogDefinition:!0},catalog:{type:"simple"},owner:{type:"filter",dataType:"string",defaultOp:"any"},access:{type:"filter",dataType:"string",defaultOp:"any"},type:{type:"filter",dataType:"string",defaultOp:"any"},hubType:{type:"filter",dataType:"string",defaultOp:"any"},downloadable:{type:"filter",dataType:"boolean"},hasApi:{type:"filter",dataType:"boolean"},openData:{type:"filter",dataType:"boolean"},id:{type:"filter",dataType:"string",defaultOp:"any",catalogDefinition:!0},collection:{type:"filter",dataType:"string",defaultOp:"any"},sector:{type:"filter",dataType:"string",defaultOp:"any"},region:{type:"filter",dataType:"string",defaultOp:"any"},initiativeId:{type:"filter",dataType:"string",defaultOp:"any",catalogDefinition:!0},categories:{type:"filter",dataType:"string",defaultOp:"any"},license:{type:"filter",dataType:"string",defaultOp:"any"},modified:{type:"filter",dataType:"string",defaultOp:"between"}}
function _e(e){return e?Object.keys(e).reduce(function(t,r){var n=Se[r]||{}
if(e[r]&&"filter"===n.type&&n.dataType){var i=e[r]
t[r]=function(e,t){var r=e.match(/(any|all|between)\((.+)\)/)
return r?{fn:r[1],terms:r[2].split(","),catalogDefinition:t.catalogDefinition}:{fn:t.defaultOp||null,terms:e.split(","),catalogDefinition:t.catalogDefinition}}(i,n)}return t},{}):{}}function je(e){return{any:" OR ",all:" AND ",not:" NOT ",between:" TO "}[e||"any"]}var Ie={downloadable:function(e){var t,r
return"true"===(C(e,"downloadable.terms")||[])[0]?(t=q.downloadableTypes.map(function(e){return'type:"'+e+'"'}),r=q.downloadableTypeKeywords.map(function(e){return'typekeywords:"'+e+'"'})):(t=q.downloadableTypes.map(function(e){return'-type:"'+e+'"'}),r=q.downloadableTypeKeywords.map(function(e){return'-typekeywords:"'+e+'"'})),"("+t.concat(r).join(" OR ")+")"},hasApi:function(e){return"("+((C(e,"hasApi.terms")||[])[0]?q.apiTypes.map(function(e){return'type:"'+e+'"'}).join(" OR "):q.apiTypes.map(function(e){return'-type:"'+e+'"'}).join(" OR "))+")"},groupIds:function(e){return"("+(C(e,"groupIds.terms")||[]).map(function(e){return'group:"'+e+'"'}).join(" OR ")+")"},collection:function(e){return"("+(C(e,"collection.terms")||[]).map(function(e){return void 0===(t=e)&&(t=""),q[t.toLowerCase()]
var t}).filter(function(e){return!!e}).reduce(function(e,t){return t.forEach(function(t){e.push('type:"'+t+'"')}),e},[]).join(" OR ")+")"}}
function Ee(e){var t=[],r=[]
if(Object.keys(e).forEach(function(n){var i
i=Ie[n]?Ie[n](e,n):function(e,t){var r,n=C(e,t+".terms")||[],i=C(e,t+".fn")
if("between"===i){var o=n[0],a=n[1]
o===a&&(a=function(e,t){try{var r=new Date(e)
return new Date(r.setDate(r.getDate()+1)).toISOString().split("T")[0]}catch(e){throw new Error("Invalid Date")}}(o))
var s=[o,a].map(function(e){return new Date(e).getTime()})
r=t.toLowerCase()+": ["+s.join(je(i))+"]"}else r=n.map(function(e){return t.toLowerCase()+':"'+e+'"'}).join(je(i))
return"not"===i&&(r="NOT "+r),"("+r+")"}(e,n),e[n].catalogDefinition?t.push(i):r.push(i)}),t.length){var n="("+t.join(" OR ")+")"
return r.length?n+" AND ("+r.join(" AND ")+")":n}return r.length?r.join(" AND "):""}function Ae(e,t,r,n){return u(this,void 0,void 0,function(){var i,o,a,s,u,p,d,f,h
return l(this,function(l){switch(l.label){case 0:return(i=function(e){void 0===e&&(e={})
var t={q:null,start:C(e,"page.start")||1,num:C(e,"page.size")||10},r=['-type:"code attachment"']
if(e.restricted&&r.push("-access:public"),e.q&&r.push(e.q),e.catalog){var n=_e(e.catalog)
r.push(Ee(n))}var i,o,a,s,u=_e(e),l=_e(e.filter),p=c({},u,l)
if(Object.keys(p).length&&r.push(Ee(p)),r=r.filter(function(e){return!!e}),t.q=r.join(" AND "),e.bbox&&(t.bbox=e.bbox),e.sort){var d="-"===e.sort[0]?"desc":"asc",f="desc"===d?e.sort.substring(1).split(",")[0]:e.sort.split(",")[0]
i=f,(f=Oe.indexOf(i)>=0?i:i in Te?Te[i]:void 0)&&(t.sortField=f,t.sortOrder=d)}if(e.agg&&e.agg.fields){var h=(o=e.agg.fields,a=o.split(",").filter(function(e){return ke.indexOf(e)>-1}),s=o.split(",").filter(function(e){return Object.keys(xe).indexOf(e)>-1}),Object.keys(xe).forEach(function(e){s.indexOf(e)>-1&&!(xe[e]in a)&&a.push(xe[e])}),{countFields:a.join(","),countSize:200}),g=h.countFields,m=h.countSize
t.countFields=g,t.countSize=m}return t}(e)).countFields?(o=function(e,t){for(var r=[],n=0;n<e.length;)r.push(e.slice(n,n+3)),n+=3
return r}(i.countFields.split(",")).map(function(e){return e.join(",")}),a=o.map(function(e){return S(c({},i,{params:{token:t,countFields:e,countSize:i.countSize},portal:r,authentication:n}))}),[4,Promise.all(a)]):[3,2]
case 1:for(s=l.sent(),u=[],p=0,d=s;p<d.length;p++)f=d[p],h=C(f,"aggregations.counts")||[],u=u.concat(h)
return s[0].aggregations={counts:u},[2,s[0]]
case 2:return[2,S(c({},i,{params:{token:t,countFields:i.countFields,countSize:i.countSize},portal:r,authentication:n}))]}})})}var De=["downloadable"],Pe=["hasApi","collection"],Re={downloadable:function(e){return e.results.reduce(function(e,t){return(t.typeKeywords||[]).indexOf("Data")>-1||q.downloadableTypes.indexOf(t.type)>-1?e.downloadable.true++:e.downloadable.false++,e},{downloadable:{true:0,false:0}})},hasApi:function(e){void 0===e&&(e={})
var t=(C(e,"counts")||[]).filter(function(e){return"type"===e.fieldName})[0]
return t?t.fieldValues.reduce(function(e,t){return be.indexOf(t.value)>-1?e.hasApi.true+=t.count:e.hasApi.false+=t.count,e},{hasApi:{true:0,false:0}}):{hasApi:{}}},collection:function(e){void 0===e&&(e={})
var t=(C(e,"counts")||[]).filter(function(e){return"type"===e.fieldName})[0]
return t?t.fieldValues.reduce(function(e,t){var r,n=L(t.value)
return r=n?n.toLowerCase().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "):"Other",e.collection[r]=t.count,e},{collection:{}}):{collection:{}}}}
function Ce(e,t,r,n,i){return void 0===e&&(e={counts:Array()}),u(this,void 0,void 0,function(){var o,a,s,u,p,d,f,h,g
return l(this,function(l){switch(l.label){case 0:return o=C(t,"agg.fields"),a=o?o.split(","):[],s=Me(a,De),u={},s.length>0?((p=c({},t,{start:1,num:100})).agg={},[4,Ae(p,r,n,i)]):[3,2]
case 1:d=l.sent(),s.forEach(function(e){var t=Re[e](d)
u=c({},u,ve(t))}),l.label=2
case 2:return f=e.counts.reduce(function(e,t){return e[t.fieldName]=t.fieldValues.map(function(e){return{key:e.value,docCount:e.count}}),e},{}),s=Me(a,Pe),h={},s.length>0&&s.forEach(function(t){var r=c({},Re[t](e))
h=c({},h,ve(r))}),(g=c({},u,f,h)).categories&&(g.categories=function(e){void 0===e&&(e=[])
var t=new Set,r=["","categories"]
return e.forEach(function(e){e.key.split("/").filter(function(e){return-1===r.indexOf(e)}).forEach(function(e){t.add(e)})}),Array.from(t).reduce(function(t,r){var n=e.filter(function(e){return e.key.includes(r)}).map(function(e){return e.docCount}).reduce(function(e,t){return e+t})
return t.push({key:r,docCount:n}),t},[])}(g.categories)),[2,g]}})})}function Me(e,t){return e.filter(function(e){return-1!==t.indexOf(e)})}function qe(e,t,r){if(e)try{var n=e.match(new RegExp(t,"ig"))
if(!n)return
return n.reduce(function(e){return function(t,r){var n='<mark class="hub-search-highlight '+e+'-highlight">'+r+"</mark>"
return t.replace(new RegExp(r,"g"),n)}}(r),e)}catch(e){return}}function Ne(e){var t,r=L(e.type),n={name:e.title,searchDescription:e.description,hubType:r||"Other",collection:F(e),extent:(t=e.extent,{coordinates:t,type:"envelope"})}
return c({},e,n)}function Le(e,t,r,n){return u(this,void 0,void 0,function(){var i,o
return l(this,function(a){switch(a.label){case 0:return[4,Ae(e,t,r,n)]
case 1:return[4,Ce((i=a.sent()).aggregations,e,t,r)]
case 2:return o=a.sent(),[2,function(e,t,r){void 0===t&&(t={})
var n=c({},r)
return{data:e.results.map(function(e){return function(e,t){var r={id:e.id,type:"item",attributes:Ne(e)}
return t&&(r.meta={},r.meta.highlights=function(e,t){return{name:qe(e.title,t,"name"),searchDescription:qe(e.description,t,"description")}}(e,t)),r}(e,n.q)}),meta:{query:e.query,queryParameters:n,stats:{aggs:t,count:e.results.length,totalCount:e.total},page:{start:e.start,size:e.num,nextStart:e.nextStart}}}}(i,o,e)]}})})}var Fe=function(){function e(e){Object(n.h)(this,e),this.results=[]}return e.prototype.queryInputHandler=function(e){return this.queryInput=e.detail,"true"},e.prototype.querySelectHandler=function(e){var t=this
return this.queryInput=e.detail,this.results=[],this.fetchResults(this.queryInput).then(function(e){console.log("Search",e),t.results=e.data}),"true"},e.prototype.componentWillLoad=function(){},e.prototype.fetchResults=function(e){return Le({q:e})},e.prototype.render=function(){var e=[]
return e.push(Object(n.g)("hub-suggest-input",{placeholder:"Search for content",suggestions:this.suggestions})),this.results.map(function(t){e.push(Object(n.g)("hub-content-card",{layout:"horizontal",content:t.id}))}),Object(n.g)(n.a,null,Object(n.g)("slot",null),e)},Object.defineProperty(e,"style",{get:function(){return":host{display:block}"},enumerable:!0,configurable:!0}),e}(),ze=function(){function e(e){var t=this
Object(n.h)(this,e),this.query="",this.placeholder="What are you looking for?",this.submit="Start Search",this.suggestions=["Apple","Avocado","Aardvark","Banana"],this.inputQuery="",this.suggestionArr=[],this.findMatch=function(e){return 0===e.length?[]:t.suggestions.filter(function(t){return t.slice(0,e.length)===e&&t!==e})},this.onSelect=function(e){t.inputQuery=e,t.selectedSuggestionIndex=void 0,t.showSuggestions=!1,t.querySelect.emit(t.inputQuery)},this.onFocus=function(){t.showSuggestions=!0,t.selectedSuggestionIndex=void 0,t.suggestionArr=t.findMatch(t.inputQuery)},this.onKeyDown=function(e){switch(e.key){case"ArrowUp":t.suggestionArr.length>0&&(t.selectedSuggestionIndex=void 0===t.selectedSuggestionIndex||0===t.selectedSuggestionIndex?t.suggestionArr.length-1:t.selectedSuggestionIndex-1)
break
case"ArrowDown":t.suggestionArr.length>0&&(t.selectedSuggestionIndex=void 0===t.selectedSuggestionIndex||t.selectedSuggestionIndex===t.suggestionArr.length-1?0:t.selectedSuggestionIndex+1)}},this.onKeyPress=function(e){"Enter"===e.key&&(e.preventDefault(),void 0!==t.selectedSuggestionIndex?t.onSelect(t.suggestionArr[t.selectedSuggestionIndex]):t.onSelect(t.inputQuery))},this.getSuggestionElement=function(e){var r=void 0!==t.selectedSuggestionIndex&&e===t.suggestionArr[t.selectedSuggestionIndex]
return Object(n.g)("li",{class:"hub-suggestions-li "+(r?"hub-suggestions-selected":""),onClick:function(){return t.onSelect(e)}},e)},this.querySelect=Object(n.d)(this,"querySelect",7),this.queryInput=Object(n.d)(this,"queryInput",7)}return e.prototype.componentWillLoad=function(){this.inputQuery=this.query},e.prototype.suggestionsDidChangeHandler=function(){this.suggestionArr=this.findMatch(this.inputQuery),this.showSuggestions=!0},e.prototype.handleWindowClick=function(e){this.element.contains(e.target)||(this.showSuggestions=!1,this.selectedSuggestionIndex=void 0)},e.prototype.onInput=function(e){return this.inputQuery=e.target.value,this.queryInput.emit(this.inputQuery),this.onFocus(),"true"},e.prototype.onSubmit=function(e){e.preventDefault(),this.query=this.inputQuery,this.onSelect(this.query)},e.prototype.render=function(){var e=this
return Object(n.g)("div",{class:"hub-suggestions-div"},Object(n.g)("form",{onSubmit:function(t){return e.onSubmit(t)}},Object(n.g)("slot",{name:"before-input"}),Object(n.g)("input",{class:"hub-suggestions-input",type:"text",placeholder:this.placeholder,value:this.inputQuery,onInput:function(t){return e.onInput(t)},onFocus:function(){return e.onFocus()},onKeyDown:function(t){return e.onKeyDown(t)},onKeyPress:function(t){return e.onKeyPress(t)}}),Object(n.g)("ul",{class:"hub-suggestions-ul",role:"listbox",hidden:!this.showSuggestions},this.suggestionArr.map(function(t){return e.getSuggestionElement(t)})),Object(n.g)("input",{class:"hub-suggest-input-submit",type:"submit",value:this.submit})))},Object.defineProperty(e.prototype,"element",{get:function(){return Object(n.f)(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"watchers",{get:function(){return{suggestions:["suggestionsDidChangeHandler"]}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"style",{get:function(){return"input[type=text]{border:none;border-bottom:2px solid grey;font-size:1.2rem;margin:5px 10px}.autocomplete{position:relative;display:inline-block}input{border:1px solid transparent;padding:10px;font-size:16px}input,input[type=text]{background-color:#f1f1f1}input[type=text]{width:60%}input[type=submit]{background-color:#1e90ff;color:#fff;cursor:pointer}input[type=submit]:hover{-webkit-box-shadow:0 8px 16px 0 rgba(0,0,0,.2);box-shadow:0 8px 16px 0 rgba(0,0,0,.2)}.autocomplete-items{position:absolute;border:1px solid #d4d4d4;border-bottom:none;border-top:none;z-index:99;top:100%;left:0;right:0}.autocomplete-items div{padding:10px;cursor:pointer;background-color:#fff;border-bottom:1px solid #d4d4d4}.autocomplete-items div:hover{background-color:#e9e9e9}.autocomplete-active{background-color:#1e90ff!important;color:#fff}.hub-suggestions-div{position:relative}.hub-suggestions-input{width:100%}.hub-suggestions-ul{list-style:none;border:1px solid #add8e6;background-color:#fff;position:absolute;margin:0;padding:0;width:80%;z-index:100;color:#333}.hub-suggestions-li:hover{cursor:pointer;background-color:#000;color:#fff}.hub-suggestions-selected{background-color:#00f;color:#fff}"},enumerable:!0,configurable:!0}),e}()},46:function(e,t,r){"use strict"
function n(e){return Array.isArray(e)?e:Array.prototype.slice.call(e)}function i(e){return a(e,"dir","ltr")}function o(e){return a(e,"theme","light")}function a(e,t,r){var n=e.closest("["+t+"]")
return n?n.getAttribute(t):r}function s(e,t){var r=e.querySelector("slot")
return n(r?r.assignedElements():e.children).filter(function(e){return e.matches(t)})}r.d(t,"a",function(){return a}),r.d(t,"b",function(){return o}),r.d(t,"c",function(){return s}),r.d(t,"d",function(){return i}),r.d(t,"e",function(){return n})},47:function(e,t,r){"use strict"
r.d(t,"a",function(){return n})
var n=function(){return[2,1,1,1,3].map(function(e){for(var t="",r=0;r<e;r++)t+=(65536*(1+Math.random())|0).toString(16).substring(1)
return t}).join("-")}},49:function(e,t,r){"use strict"
r.d(t,"a",function(){return i}),r.d(t,"b",function(){return n}),r.d(t,"c",function(){return o})
var n="M6.293 12l4-4-4-4h1.414l4 4-4 4z",i="M8.718 8l5.303 5.303-.707.707L8.01 8.707 2.707 14.01 2 13.303 7.303 8 2 2.697l.707-.707L8.01 7.293l5.304-5.303.707.707z",o="M13.207 12.5l7.778 7.778-.707.707-7.778-7.778-7.778 7.778-.707-.707 7.778-7.778-7.778-7.778.707-.707 7.778 7.778 7.778-7.778.707.707z"}}])
